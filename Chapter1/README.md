# Chapter 1 리팩터링: 첫 번째 예시

> 프로그램이 새로운 기능을 추가하기에 편한 구조가 아니라면, 먼저 기능을 추가하기 쉬운 형태로 리팩터링하고 나서 원하는 기능을 추가한다.

> 리팩터링이 필요한 이유는 변경 때문이다. 잘 작동하고 나중에 변경할 일이 절대 없다면 코드를 현재 상태로 나둬도 아무런 문제가 없다. 하지만 다른 사람이 읽고 이해해야 할 일이 생겼는데 로직을 파악하기 어렵다면 뭔가 대책을 마련해야 한다.

## 리팩터링의 첫 단계

리팩터링의 첫 단계는 **테스트 코드**를 작성하는 것이다. 우리 예제의 `statement()` 함수의 테스트 코드는 공연 종류에 따라 다른 문자열을 반환하므로 다양한 장르의 공연들로 구성된 공연료 청구서 몇 개를 문자열 형태로 준비해두고, `statement()` 함수가 반환한 문자열과 정답 문자열을 비교하면 된다. 그리고 이 테스트를 단축키 하나로 실행할 수 있도록 설정해두면 끝이다.

여기서 중요한 부분은 테스트의 결과를 보고하는 방식이다. 출력된 문자열이 정답 문자열과 똑같다면 테스트를 통과했다는 의미의 초록불을 켜고, 조금이라도 다르면 실패를 뜻하는 빨간불을 켠다. 성공/실패를 판단하는 자가진단 테스트를 만들어야 하는 것이 가장 중요하다.

> 리팩터링하기 전에 제대로 된 테스트부터 마련한다. 테스트는 반드시 자가진단하도록 만든다.

테스트를 작성하는 데 시간이 걸리지만 잘 만든 테스트 코드는 디버깅 시간을 줄여줘서 전체 작업 시간을 단축시킨다. 리팩터링에서 테스트의 역할은 굉장히 중요하다!
